---
layout: post
categories: C/C++开发环境
tags: [WSL, Linux]
---

###### 名词解释
**MinGW**是**Minimalist GNU for Windows**的缩写，意为Windows下GNU的最小环境。

## Part 1、安装和设置MinGW

### 一、安装

请将教师分发给大家的`MinGW64.zip`解压到任意一个盘，例如`C:`盘。解压后生成的文件夹是：`C:\MinGW64`。这里给出一个解压后的目录结构示意：
```
C:\
 +--- MinGW64
         |------ bin
         |------ include
         |------ lib
         |------ libexec
         |------ share
         +------ x86_64-w64-mingw32
```
请注意，主目录`MinGW64`只有一层，子目录`bin`直接在其下。

>常见的错误是：因为解压操作的原因，可能导致生成这样的目录：C:\MinGW64\MinGW64。

你也可以自行下载最新版本的`MinGW`，然后按照上述步骤安装。

### 二、设置

1. 在**此电脑**上点击右键，选择**属性**->**高级系统设置**->**环境变量**，在**系统变量**栏目中找到**Path**并双击它。

2. 在弹出的窗口中，选择**新建**，在左侧编辑区的新建项中，输入`C:\MinGW64\bin`。此后一路**确定**。

3. 进入`C:\MinGW64\bin`文件夹，找到文件`mingw32-make.exe`，将其复制粘贴到同一文件夹下，并将复制件改名为：`make.exe`。

>这样做的目的是为了在Windows下也能用约定俗成的方式使用make工具。

>注意：如果你看不到文件的.exe之类的后缀，那么请打开任意一个文件夹，然后点击查看 -> 显示，勾选 文件扩展名。

## Part 2、使用VS Code+MinGW

假设你将源文件都存放在`D:\tmp`目录中。即这是你的**工作目录**。

1. 启动`VS Code`，点击左上角的文件图标，在点击**打开文件夹**按钮，选择你的工作目录，然后确定。

2. 在弹出的对话框中，勾选“信任xxx文件的作者...”，再点击下方的“是的，我信任作者”按按钮。此后，改文件夹里面的所有文件就会列在Code的左侧栏中。

3. 选择一个已有的，或者新建源文件编辑，保存为`.c`文件。

4. 按组合建**CTRL+\`**（\`键在键盘左上角`ESC`键的下方），调出Code内嵌的终端（一般是`Powershell`）。可以看到，终端已自动进入到你的工作文件夹。

5. 按`CTRL+N`新建一个文件，然后在其中输入一段程序代码，例如：
    ```C
    #include <stdio.h>

    int main() {
        printf("Hello!\n");
        return 0;
    }
    ```
    然后按`CTRL+S`，保存为`f.c`。

    注意：
    - 扩展名`.c`非常重要！
    - 将文件保存到D:\tmp目录下。一定不要保存到`.vscode`目录下！

6. 在终端中发出如下命令编译链接程序：
    ```Powershell
    gcc f.c
    ```
    如果无错则会生成可执行文件`a.exe`（这是系统默认的名字）。按如下方法运行这个程序：
    ```Powershell
    .\a
    ```

    如果需要指定生成可执行文件的名字，那么请这么做：
    或者
    ```Powershell
    gcc f.c -o myapp
    ```
    那么生成的可执行文件的名字就是`myapp.exe`。按如下方法运行这个程序：
    ```Powershell
    .\myapp
    ```

    >MinGW目前还没有内存消毒器库的支持，因此编译命令行无法加上 -fsanitize=address 等选项。