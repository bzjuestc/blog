---
layout: post
categories: C/C++开发环境
tags: [macOS, gcc/g++]
---

## Part 1、检测clang的存在

`clang`是`macOS`下的C/C++编译器。如果你的系统中安装了`XCode`，那么一般都自带了`clang`。可以这样来验证一下。

启动一个终端，在其中发出如下命令：
```bash
clang -v
gcc -v
```
如果没有报错，且显示出了版本号，那么说明clang已经存在了。这种情况下请直接跳到Part 3。

>注意，这里的`gcc`实际上是`clang`的别名。

## Part 2、安装C编译器

这里有两个选择：一是安装`XCode`，二是安装真正的`gcc`。强烈建议选择前者。

如果一定要安装`gcc`，那么请这么做：

1. 安装macOS的包管理器`Homebrew`。

    启动一个终端，在其中发出如下命令：
    ```bash
    /bin/bash -c "$(curl -fsSL https://gitee.com/ineo6/homebrew-install/raw/master/install.sh)"
    ```
    此后根据命令的提示，将环境变量添加到路径中。
    >安装命令执行时显示的信息有明确的提示和示范，请关注这些信息。

2. 安装gcc/g++

    在终端中执行如下命令：
    ```bash
    brew install gcc g++
    ```
    >brew是macOS的一种包管理器，相当于Linux下的apt。

    >以上方法摘自网络，如有错误，请自行解决。

## Part 3、安装VS Code
从微软官网下载适合macOS的VS Code版本进行安装。

## Part 4、编译链接运行程序
假设你将源文件都存放在`/usr/local/tmp`目录中。即这是你的**工作目录**。

1. 启动`VS Code`，点击左上角的文件图标，在点击**打开文件夹**按钮，选择你的工作目录，然后确定。

2. 在弹出的对话框中，勾选“信任xxx文件的作者...”，再点击下方的“是的，我信任作者”按按钮。此后，改文件夹里面的所有文件就会列在`VS Code`的左侧栏中。

3. 选择一个已有的，或者新建源文件编辑，保存为`.c`文件。新建过程是这样的：按`CTRL+N`新建一个文件，然后在其中输入一段程序代码，例如：
    ```C
    #include <stdio.h>

    int main() {
        printf("Hello!\n");
        return 0;
    }
    ```
    然后按`CTRL+S`，保存为`f.c`。注意，不要将其保存到`.vscode`子目录中！

4. 按组合建**CTRL+\`**（\`键在键盘左上角`ESC`键的下方），调出`VS Code`内嵌的终端。可以看到，终端已自动进入到你的工作文件夹。

5. 在终端中发出如下命令编译链接程序：
    ```bash
    gcc f.c
    ```
    如果无错则会生成可执行文件`a.out`（这是系统默认的名字）。按如下方法运行这个程序：
    ```bash
    ./a.out
    ```

    如果需要指定生成可执行文件的名字，那么请这么做：
    或者
    ```bash
    gcc f.c -o myapp
    ```
    那么生成的可执行文件的名字就是`myapp`。按如下方法运行这个程序：
    ```bash
    ./myapp
    ```

    如果你的程序使用了数组、指针等容易出现内存访问错误的机制，那么可以这么做：
    ```bash
    gcc f.c -fsanitize=address
    ```
    这将启动内存消毒器机制，可以在程序运行时诊断处内存访问错误。根据错误提示可以定位源代码中的逻辑错误。
    
---